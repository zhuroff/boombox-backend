# Example Nginx configuration for additional indexing protection
# 
# DEPLOYMENT INSTRUCTIONS (VPS via SSH):
# 
# 1. Copy this config to your VPS:
#    scp nginx.example.conf user@your-server:/tmp/
#
# 2. SSH into your server:
#    ssh user@your-server
#
# 3. Create/edit Nginx site configuration:
#    sudo nano /etc/nginx/sites-available/boombox
#
# 4. Paste and adapt this configuration (change paths, domain, ports)
#
# 5. Create symbolic link to enable the site:
#    sudo ln -s /etc/nginx/sites-available/boombox /etc/nginx/sites-enabled/
#
# 6. Test Nginx configuration:
#    sudo nginx -t
#
# 7. Reload Nginx:
#    sudo systemctl reload nginx
#
# 8. Check status:
#    sudo systemctl status nginx

server {
  listen 80;
  # TODO: Change to your domain or server IP
  server_name your-domain.com;

  # Prevent indexing at server level
  add_header X-Robots-Tag "noindex, nofollow, noarchive, nosnippet, noimageindex" always;

  # Frontend (static files)
  location / {
    # TODO: Change to actual path where you deployed frontend dist folder
    # Example: /var/www/boombox/frontend/dist
    root /path/to/boombox-frontend/dist;
    try_files $uri $uri/ /index.html;
    
    # Duplicate header for static files
    add_header X-Robots-Tag "noindex, nofollow, noarchive" always;
  }

  # Backend API
  location /api/ {
    # TODO: Change port if your backend runs on different port
    # Default backend port is 3001 (see boombox-backend/src/index.ts)
    proxy_pass http://localhost:3001;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;
    
    # X-Robots-Tag is already added by backend middleware
  }

  # Block known search engine bots (403 error)
  if ($http_user_agent ~* (googlebot|bingbot|yandex|baiduspider)) {
    return 403;
  }

  # Optional: IP whitelist protection (uncomment and configure if needed)
  # allow 192.168.1.0/24;  # Your local network
  # allow 10.0.0.0/8;      # VPN range
  # deny all;
}

